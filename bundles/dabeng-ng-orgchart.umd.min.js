!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/platform-browser/animations"),require("rxjs"),require("@angular/animations")):"function"==typeof define&&define.amd?define("@dabeng/ng-orgchart",["exports","@angular/core","@angular/common","@angular/platform-browser/animations","rxjs","@angular/animations"],e):e(((t=t||self).dabeng=t.dabeng||{},t.dabeng["ng-orgchart"]={}),t.ng.core,t.ng.common,t.ng.platformBrowser.animations,t.rxjs,t.ng.animations)}(this,(function(t,e,o,n,r,i){"use strict";var a=function(){function t(){this.subject=new r.Subject}return t.prototype.sendSelect=function(t){this.subject.next({id:t})},t.prototype.clearSelect=function(){this.subject.next()},t.prototype.getSelect=function(){return this.subject.asObservable()},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[]},t}();var s=function(){function t(t){this.nodeSelectService=t,this.nodeHeading="name",this.nodeContent="title",this.groupScale=3,this.pan=!1,this.zoom=!1,this.zoomoutLimit=.5,this.zoominLimit=7,this.containerClass="",this.chartClass="",this.select="single",this.nodeClick=new e.EventEmitter,this.chartClick=new e.EventEmitter,this.cursorVal="default",this.panning=!1,this.startX=0,this.startY=0,this.transformVal=""}return t.prototype.ngOnInit=function(){},t.prototype.panEndHandler=function(){this.panning=!1,this.cursorVal="default"},t.prototype.panHandler=function(t){var e=0,o=0;if(t.targetTouches){if(1===t.targetTouches.length)e=t.targetTouches[0].pageX-this.startX,o=t.targetTouches[0].pageY-this.startY;else if(t.targetTouches.length>1)return}else e=t.pageX-this.startX,o=t.pageY-this.startY;if(""===this.transformVal)-1===this.transformVal.indexOf("3d")?this.transformVal="matrix(1,0,0,1,"+e+","+o+")":this.transformVal="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+e+", "+o+",0,1)";else{var n=this.transformVal.split(",");-1===this.transformVal.indexOf("3d")?(n[4]=e.toString(),n[5]=o+")"):(n[12]=e.toString(),n[13]=o.toString()),this.transformVal=n.join(",")}},t.prototype.panStartHandler=function(t){if(t.target.querySelectorAll(".node")&&t.target.querySelectorAll(".node").length)this.panning=!1;else{this.cursorVal="move",this.panning=!0;var e=0,o=0;if(""!==this.transformVal){var n=this.transformVal.split(",");-1===this.transformVal.indexOf("3d")?(e=parseInt(n[4],10),o=parseInt(n[5],10)):(e=parseInt(n[12],10),o=parseInt(n[13],10))}if(t.targetTouches){if(1===t.targetTouches.length)this.startX=t.targetTouches[0].pageX-e,this.startY=t.targetTouches[0].pageY-o;else if(t.targetTouches.length>1)return}else this.startX=t.pageX-e,this.startY=t.pageY-o}},t.prototype.setChartScale=function(t){var e=[],o=1;""===this.transformVal?this.transformVal="matrix("+t+", 0, 0, "+t+", 0, 0)":(e=this.transformVal.split(","),-1===this.transformVal.indexOf("3d")?(o=Math.abs(parseFloat(e[3])*t))>this.zoomoutLimit&&o<this.zoominLimit&&(e[0]="matrix("+o,e[3]=o,this.transformVal=e.join(",")):(o=Math.abs(parseFloat(e[5])*t))>this.zoomoutLimit&&o<this.zoominLimit&&(e[0]="matrix3d("+o,e[5]=o,this.transformVal=e.join(",")))},t.prototype.zoomHandler=function(t){var e=1+(t.deltaY>0?-.2:.2);this.setChartScale(e)},t.prototype.onClickChart=function(t){t.target.closest(".oc-node")||(this.chartClick.emit(),this.nodeSelectService.clearSelect())},t.prototype.onNodeClick=function(t){this.nodeClick.emit(t)},t.decorators=[{type:e.Component,args:[{selector:"organization-chart",template:'<div class="orgchart-container" [ngClass]="containerClass" (wheel)="zoom ? zoomHandler($event) : true"\n\t(mouseup)="pan && panning ? panEndHandler() : true">\n\t<div class="orgchart" [ngClass]="chartClass" [ngStyle]="{\'transform\': transformVal, \'cursor\': cursorVal}"\n\t\t(mousedown)="pan ? panStartHandler($event) : true" (mousemove)="pan && panning ? panHandler($event) : true"\n\t\t(click)="onClickChart($event)">\n\t\t<orgchart-node [datasource]="datasource" [nodeHeading]="nodeHeading" [nodeContent]="nodeContent"\n\t\t\t[nodeTemplate]="nodeTemplate" [groupScale]="groupScale" [select]="select" (nodeClick)="onNodeClick($event)"></orgchart-node>\n\t</div>\n</div>',styles:[".orgchart-container{box-sizing:border-box;position:relative;margin:10px;height:700px;border:2px dashed #aaa;border-radius:5px;overflow:auto;text-align:center}.orgchart{box-sizing:border-box;display:inline-block;background-image:linear-gradient(90deg,rgba(200,0,0,.15) 10%,rgba(0,0,0,0) 10%),linear-gradient(rgba(200,0,0,.15) 10%,rgba(0,0,0,0) 10%);background-size:10px 10px;border:1px dashed transparent;padding:20px}"]}]}],t.ctorParameters=function(){return[{type:a}]},t.propDecorators={datasource:[{type:e.Input}],nodeHeading:[{type:e.Input}],nodeContent:[{type:e.Input}],nodeTemplate:[{type:e.Input}],groupScale:[{type:e.Input}],pan:[{type:e.Input}],zoom:[{type:e.Input}],zoomoutLimit:[{type:e.Input}],zoominLimit:[{type:e.Input}],containerClass:[{type:e.Input}],chartClass:[{type:e.Input}],select:[{type:e.Input}],nodeClick:[{type:e.Output}],chartClick:[{type:e.Output}]},t}();var l=function(){function t(t){var o=this;this.nodeSelectService=t,this.nodeClick=new e.EventEmitter,this.Arr=Array,this.isCollapsed=!1,this.subscription=this.nodeSelectService.getSelect().subscribe((function(t){t&&t.id?o.isSelected=o.datasource.id===t.id:o.isSelected=!1}))}return t.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},t.prototype.ngOnInit=function(){},t.prototype.toggleChildren=function(){this.isCollapsed=!this.isCollapsed},t.prototype.toggleAnimStart=function(t){this.isCollapsed?t.element.parentElement&&t.element.parentElement.parentElement&&t.element.parentElement.parentElement.classList.contains("orgchart")&&t.element.previousElementSibling.classList.add("oc-is-collapsed"):this.ecStyles={display:"flex"}},t.prototype.toggleAnimEnd=function(t){this.isCollapsed?this.ecStyles={display:"none"}:t.element.parentElement&&t.element.parentElement.parentElement&&t.element.parentElement.parentElement.classList.contains("orgchart")&&t.element.previousElementSibling.classList.remove("oc-is-collapsed")},t.prototype.onClickNode=function(t){this.nodeClick.emit(this.datasource),"single"===this.select?this.nodeSelectService.sendSelect(this.datasource.id):"multiple"===this.select&&(this.isSelected=!this.isSelected)},t.prototype.onNodeClick=function(t){this.nodeClick.emit(t)},t.decorators=[{type:e.Component,args:[{selector:"orgchart-node",template:'<div class="oc-node" [id]="\'oc-\' + datasource.id" [class.oc-is-selected]="isSelected" (click)="onClickNode($event)">\n\t<ng-container\n\t\t*ngTemplateOutlet="nodeTemplate ? nodeTemplate : defaultNodeTemplate; context:{ datasource:datasource,nodeHeading: nodeHeading, nodeContent: nodeContent }">\n\t</ng-container>\n\t<i *ngIf="datasource.children" [ngClass]="{\'oc-icon-plus\': isCollapsed, \'oc-icon-minus\': !isCollapsed}" (click)="toggleChildren()" class="oc-toggle-btn oc-icon"></i>\n</div>\n<div *ngIf="datasource.children" [@expandCollapse]="isCollapsed ? \'collapsed\' : \'expanded\'"\n\t(@expandCollapse.start)="toggleAnimStart($event)" (@expandCollapse.done)="toggleAnimEnd($event)"\n\t[ngStyle]="ecStyles" class="oc-groups">\n\t<ng-container *ngFor="let node of datasource.children;let i=index">\n\t\t<div *ngIf="i % groupScale === 0" class="oc-group">\n\t\t\t<ng-container *ngFor="let temp of Arr(groupScale);let j=index;">\n\t\t\t\t<orgchart-node *ngIf="i + j < datasource.children.length" [datasource]="datasource.children[i + j]"\n\t\t\t\t\t[nodeHeading]="nodeHeading" [nodeContent]="nodeContent" [nodeTemplate]="nodeTemplate"\n\t\t\t\t\t[groupScale]="groupScale" [select]="select" (nodeClick)="onNodeClick($event)">\n\t\t\t\t</orgchart-node>\n\t\t\t</ng-container>\n\t\t</div>\n\t</ng-container>\n</div>\n\n<ng-template #defaultNodeTemplate let-nodeData="datasource" let-heading="nodeHeading" let-content="nodeContent">\n\t<div class="oc-node-heading">{{nodeData[heading]}}</div>\n\t<div class="oc-node-content">{{nodeData[content]}}</div>\n</ng-template>',animations:[i.trigger("expandCollapse",[i.state("expanded",i.style({transform:"translateY(0)",opacity:1})),i.state("collapsed",i.style({transform:"translateY(-50px)",opacity:0})),i.transition("expanded => collapsed",[i.animate("0.2s")]),i.transition("collapsed => expanded",[i.animate("0.2s")])])],styles:['.oc-groups{display:flex;flex-direction:row}.orgchart>:host{align-items:center}.orgchart>:host>.oc-node::after{content:"";box-sizing:border-box;bottom:-10px;left:50%;height:10px;width:2px;position:absolute;background-color:rgba(217,83,79,.8)}.orgchart>:host>.oc-node.oc-is-collapsed::after{display:none}.orgchart>:host>.oc-groups>.oc-group>:host::before{height:35px;top:-10px}.oc-node{width:140px;font-family:Arial;box-sizing:border-box;position:relative;padding:3px;margin:0;border:2px solid transparent;text-align:center}.oc-node.oc-is-selected,.oc-node:hover{background-color:rgba(238,217,54,.5)}.oc-node .oc-node-heading{box-sizing:border-box;padding:2px;margin:0;width:130px;height:20px;text-align:center;font-size:.75rem;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;background-color:rgba(217,83,79,.8);color:#fff;border-radius:4px 4px 0 0}.oc-node .oc-node-content{box-sizing:border-box;padding:2px;width:130px;height:20px;font-size:.625rem;border:1px solid rgba(217,83,79,.8);border-radius:0 0 4px 4px;text-align:center;background-color:#fff;color:#333;text-overflow:ellipsis;white-space:nowrap}.oc-node .oc-toggle-btn{color:#fff;background-color:rgba(68,157,68,.6);position:absolute;left:5px;bottom:5px}.oc-group{display:flex;flex-direction:column;padding-left:20px;position:relative;padding-top:20px}.orgchart>:host>.oc-groups>.oc-group:first-child{padding-left:10px}.oc-group:not(:last-child)::before{content:"";box-sizing:border-box;top:10px;left:12px;width:calc(100% - 2px);position:absolute;border-color:rgba(217,83,79,.8);border-style:solid;border-width:0 0 2px}.orgchart>:host>.oc-groups>.oc-group:first-child::before{width:calc(100% + 8px);left:2px}:host{position:relative;display:flex;flex-direction:column}:host:not(:last-child){padding-bottom:10px}.oc-group>:host::before{content:"";box-sizing:border-box;height:35px;width:10px;position:absolute;left:-10px;top:-10px;border-color:rgba(217,83,79,.8);border-style:solid;border-width:0 0 2px 2px}.oc-group:first-child>:host:first-child::before{height:45px;top:-20px}:host:not(:last-child)::after{content:"";box-sizing:border-box;height:calc(100% - 35px);width:10px;position:absolute;left:-10px;top:25px;border-color:rgba(217,83,79,.8);border-style:solid;border-width:0 0 0 2px}.oc-icon{display:inline-block;width:1rem;height:1rem;line-height:1rem;text-align:center}.oc-icon-minus::before{content:"\\2212"}.oc-icon-plus::before{content:"\\002B"}']}]}],t.ctorParameters=function(){return[{type:a}]},t.propDecorators={datasource:[{type:e.Input}],nodeHeading:[{type:e.Input}],nodeContent:[{type:e.Input}],nodeTemplate:[{type:e.Input}],groupScale:[{type:e.Input}],select:[{type:e.Input}],nodeClick:[{type:e.Output}]},t}();var c=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[s,l],imports:[o.CommonModule,n.BrowserAnimationsModule],exports:[s,l],providers:[a]}]}],t}();t.OrgchartModule=c,t.ɵa=s,t.ɵb=a,t.ɵc=l,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=dabeng-ng-orgchart.umd.min.js.map